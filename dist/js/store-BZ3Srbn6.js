import"./modulepreload-polyfill-B5Qt9EMX.js";import"./access-control-DjWUYuMn.js";import"./url-cleaner-Bn7ZNmfv.js";import{C as g}from"./custom-navigation-jeY08-eb.js";import{A as u,M as c,b as h}from"./ascii3d-engine-CtqSC7ar.js";class f{constructor(e={}){this.config={groupOffset:{x:"0%",y:"0%"},enableRandomization:!1,engines:[{id:"storeAsciiCanvas1",model:"cube",position:{x:"25%",y:"35%"},size:{width:520,height:390},scale:3,color:"#ffffff",autoRotate:!0,rotationSpeed:.01,opacity:1},{id:"storeAsciiCanvas2",model:"cube",position:{x:"50%",y:"35%"},size:{width:520,height:390},scale:3,color:"#ffffff",autoRotate:!0,rotationSpeed:.01,opacity:1},{id:"storeAsciiCanvas3",model:"cube",position:{x:"75%",y:"35%"},size:{width:520,height:390},scale:3,color:"#ffffff",autoRotate:!0,rotationSpeed:.01,opacity:1}],enableEngines:!0,enableLogging:!1,zIndex:-1,performanceMode:"medium",...e},this.engines=[],this.initialized=!1,this.randomizationTimer=null,this.currentRandomModel=null}async init(){if(!this.config.enableEngines){console.log("🎨 ASCII engines disabled in config");return}try{console.log("🎨 Initializing store ASCII background engines..."),console.log(`🎨 Found ${this.config.engines.length} engine configurations`),console.log("🎨 Checking canvas elements in DOM...");const e=document.querySelectorAll("canvas");console.log(`🎨 Found ${e.length} canvas elements:`,Array.from(e).map(t=>t.id));for(const t of this.config.engines){const o=document.getElementById(t.id);console.log(`🎨 Canvas ${t.id}: ${o?"EXISTS":"NOT FOUND"}`),o&&console.log(`🎨 Canvas ${t.id} details:`,{offsetWidth:o.offsetWidth,offsetHeight:o.offsetHeight,style:o.style.cssText,visible:o.offsetParent!==null})}for(let t=0;t<this.config.engines.length;t++){const o=this.config.engines[t];console.log(`🎨 Initializing engine ${t+1}/${this.config.engines.length}: ${o.id}`);try{await this.initEngine(o),console.log(`✅ Engine ${o.id} initialized successfully`)}catch(i){console.error(`❌ Engine ${o.id} failed to initialize:`,i)}}this.initialized=!0,console.log(`🎨 Initialization complete. Active engines: ${this.engines.length}/${this.config.engines.length}`),this.engines.forEach((t,o)=>{console.log(`🎨 Active engine ${o}:`,{id:t.config.id,hasASCIIEffect:!!t.engine.asciiEffect,hasRenderer:!!t.engine.renderer,hasModel:!!t.engine.currentModel})}),this.config.enableRandomization&&setTimeout(()=>{this.startRandomization()},1e4)}catch(e){console.error("❌ Failed to initialize store ASCII engines:",e)}}async initEngine(e){console.log(`🎨 Starting initEngine for ${e.id}`);const t=document.getElementById(e.id);if(!t){console.error(`❌ Canvas ${e.id} not found`),console.error("❌ Available elements:",document.querySelectorAll("canvas"));return}console.log(`✅ Canvas found: ${e.id}`,t),this.styleCanvas(t,e),console.log("✅ Canvas styled"),console.log("🎨 Creating ASCII3DEngine...");const o=new u;console.log("🎨 Initializing ASCII3DEngine...");try{await o.init(t),console.log("✅ ASCII3DEngine initialized successfully"),setTimeout(()=>{if(console.log(`🔍 DEEP DEBUG for ${e.id}:`),console.log("- Engine object:",o),console.log("- Engine.asciiEffect:",o.asciiEffect),console.log("- Engine.scene:",o.scene),console.log("- Engine.camera:",o.camera),console.log("- Engine.currentModel:",o.currentModel),console.log("- Engine.isRunning:",o.isRunning),console.log("- Engine.isInitialized:",o.isInitialized),console.log("- Scene children count:",o.scene?o.scene.children.length:0),o.asciiEffect&&o.asciiEffect.domElement){const i=o.asciiEffect.domElement;console.log(`🔍 ASCII DOM Element for ${e.id}:`),console.log("- Element type:",i.tagName),console.log("- Element classes:",i.className),console.log("- Element ID:",i.id),console.log("- Element style.display:",i.style.display),console.log("- Element style.visibility:",i.style.visibility),console.log("- Element textContent length:",i.textContent?i.textContent.length:0),console.log("- Element innerHTML length:",i.innerHTML?i.innerHTML.length:0),console.log("- Element parent:",i.parentNode),console.log("- Element in document:",document.contains(i)),document.contains(i)||(console.log("🚨 CRITICAL ISSUE: ASCII DOM element is NOT attached to document!"),console.log("🔧 FORCING attachment to document body..."),document.body.appendChild(i),console.log("✅ ASCII element attached to body"))}else console.error(`❌ NO ASCII EFFECT or domElement created for ${e.id}`),console.log("- Available engine properties:",Object.keys(o))},1e3)}catch(i){console.error("❌ ASCII3DEngine init failed:",i);return}await this.loadModel(o,e.model),this.configureEngine(o,e),o.renderer&&(o.renderer.setClearColor(0,0),console.log("🎨 Set renderer background to TRANSPARENT")),setTimeout(()=>{o.startAnimation?(o.startAnimation(),console.log("🎨 Engine animation started")):o.animate&&(o.animate(),console.log("🎨 Engine animation started via animate()"));let i=0;const n=e.rotationSpeed,s=()=>{o.currentModel&&(i+=n,o.currentModel.rotation.y=i,o.currentModel.rotation.x=i*.5),requestAnimationFrame(s)};s(),console.log(`🎯 Manual rotation started with speed: ${n}`),console.log("🎨 Final engine state:",{autoRotate:o.autoRotate,rotationSpeed:o.rotationSpeed,modelScale:o.currentModel?o.currentModel.scale:"no model",textColor:o.textColor})},1e3),this.engines.push({engine:o,canvas:t,config:e}),this.log(`Engine ${e.id} initialized with model: ${e.model}`)}styleCanvas(e,t){const o=this.calculatePosition(t.position.x,this.config.groupOffset.x),i=this.calculatePosition(t.position.y,this.config.groupOffset.y);e.style.position="absolute",e.style.left=o,e.style.top=i,e.style.transform="translate(-50%, -50%)",e.style.width=t.size.width+"px",e.style.height=t.size.height+"px",e.style.opacity=t.opacity,e.style.zIndex=this.config.zIndex,e.style.pointerEvents="none",e.width=t.size.width,e.height=t.size.height,console.log(`🎨 Canvas styled: ${t.id} at ${t.position.x}+${this.config.groupOffset.x}, ${t.position.y}+${this.config.groupOffset.y} = ${o}, ${i}`)}calculatePosition(e,t){if(typeof e=="string"&&e.includes("%")&&typeof t=="string"&&t.includes("%")){const o=parseFloat(e),i=parseFloat(t);return`${o+i}%`}if(typeof e=="string"&&e.includes("px")&&typeof t=="string"&&t.includes("px")){const o=parseFloat(e),i=parseFloat(t);return`${o+i}px`}return`calc(${e} + ${t})`}selectWeightedRandomModel(){const e=Object.keys(c),t=Object.values(c),o=[];let i=0;for(const s of t)i+=s,o.push(i);const n=Math.random()*i;for(let s=0;s<o.length;s++)if(n<=o[s])return e[s];return e[0]}startRandomization(){this.config.enableRandomization&&(this.stopRandomization(),this.randomizationTimer=setInterval(()=>{this.randomizeAllModels()},this.config.randomizationInterval),console.log(`🎲 Randomization timer started - first change in ${this.config.randomizationInterval/1e3}s`))}stopRandomization(){this.randomizationTimer&&(clearInterval(this.randomizationTimer),this.randomizationTimer=null,console.log("🎲 Randomization stopped"))}async randomizeAllModels(){if(!this.config.syncAllCubes)return;const e=this.selectWeightedRandomModel();this.currentRandomModel=e,console.log(`🎲 Randomizing all cubes to: ${e}`);const t=[];for(let i=0;i<this.engines.length;i++){const{engine:n}=this.engines[i];n&&n.currentModel&&(t[i]={x:n.currentModel.rotation.x,y:n.currentModel.rotation.y,z:n.currentModel.rotation.z},console.log(`🎯 Captured rotation for engine ${i}:`,t[i]))}const o=[];for(let i=0;i<this.engines.length;i++){const{engine:n}=this.engines[i];if(n&&n.switchToModel)try{const s=n.switchToModel(e).then(()=>{t[i]&&n.currentModel&&(n.currentModel.rotation.x=t[i].x,n.currentModel.rotation.y=t[i].y,n.currentModel.rotation.z=t[i].z,console.log(`🎯 Restored rotation for engine ${i}`))});o.push(s),console.log(`🎲 Starting engine ${i} switch to: ${e}`)}catch(s){console.error(`🎲 Failed to setup randomization for engine ${i}:`,s)}}try{await Promise.all(o),console.log(`🎲 All engines completed switch to: ${e} with preserved rotations`)}catch(i){console.error("🎲 Some engines failed to switch:",i)}console.log(`🎲 All cubes randomization completed for: ${e}`)}configureEngine(e,t){if(console.log("🎨 Configuring engine with config:",t),e.textColor!==void 0&&(e.textColor=t.color,console.log(`🎨 Set textColor to: ${t.color}`)),e.camera&&(e.camera.position.set(2,2,2),e.camera.lookAt(0,0,0),e.cameraDistance=2,console.log("🎨 Camera positioned much closer for larger view")),e.currentModel){let o=t.scale;(e.currentModel.name==="castle-archers"||e.currentModel.userData&&e.currentModel.userData.modelName==="castle-archers")&&(o=t.scale*.3,console.log(`🎨 Applied STORE-SPECIFIC scaling for castle-archers: ${o}`)),e.currentModel.scale.set(o,o,o),console.log(`🎨 Model scaled to: ${o}`)}if(e.autoRotate=!1,e.rotationSpeed=0,console.log("🎨 AutoRotate DISABLED - we'll control rotation manually"),e.mouseX=0,e.mouseY=0,e.targetMouseX=0,e.targetMouseY=0,console.log("🎨 Mouse controls disabled"),e.asciiEffect){const o=e.asciiEffect.domElement;o.style.display="block",o.style.position="absolute",o.style.top=t.position.y,o.style.left=t.position.x,o.style.transform="translate(-50%, -50%)",o.style.width=t.size.width+"px",o.style.height=t.size.height+"px",o.style.background="transparent",o.style.opacity=t.opacity.toString(),o.style.color=t.color,o.style.fontFamily="monospace",o.style.fontSize="10px",o.style.lineHeight="1.0",o.style.letterSpacing="0px",o.style.pointerEvents="none",o.style.whiteSpace="pre",o.style.overflow="hidden",console.log(`🎨 Applied ESSENTIAL ASCII styling for ${t.id}`)}if(e.renderer&&(e.renderer.setClearColor(0,0),console.log("🎨 Set transparent renderer background")),e.setResolution&&(e.setResolution(150,80),console.log("🎨 Set WORKING resolution: 150x80")),e.characterSet!==void 0&&(e.characterSet=" .'`^\",:;Il!i><~+_-?][}{1)(|\\/tfjrxnuvczXYUJCLQ0OZmwqpdbkhao*#MW&8%B@$",console.log("🎨 Set STABLE character set")),e.setPerformanceMode){console.log(`🎨 BEFORE performance mode - rotation speed: ${e.rotationSpeed}`),e.setPerformanceMode(this.config.performanceMode),console.log(`🎨 AFTER performance mode - rotation speed: ${e.rotationSpeed}`),e.rotationSpeed=t.rotationSpeed,console.log(`🎨 FORCED rotation speed to: ${t.rotationSpeed}`);const o=()=>{e.rotationSpeed!==t.rotationSpeed&&(console.log(`🎨 CORRECTING speed from ${e.rotationSpeed} to ${t.rotationSpeed}`),e.rotationSpeed=t.rotationSpeed)};setTimeout(()=>o(),100),setTimeout(()=>o(),500),setTimeout(()=>o(),1e3),setTimeout(()=>o(),2e3),setTimeout(()=>o(),3e3)}}async loadModel(e,t){t==="random"&&(this.currentRandomModel?t=this.currentRandomModel:(t=this.selectWeightedRandomModel(),this.currentRandomModel=t),console.log(`🎲 Random model selected: ${t}`)),console.log(`🎨 Loading model: ${t}`);try{e.loadModel?(await e.loadModel(t),console.log(`🎨 Model ${t} loaded successfully`)):console.error("🎨 Engine missing loadModel method"),this.log(`Model ${t} loaded for engine`)}catch(o){console.error(`🎨 Failed to load model ${t}:`,o);try{await e.loadModel("cube"),this.log("Fallback cube model loaded for engine")}catch(i){console.error("🎨 Even fallback failed:",i)}}}moveGroup(e,t){return this.config.groupOffset.x=e,this.config.groupOffset.y=t,this.engines.forEach(({canvas:o,config:i})=>{this.styleCanvas(o,i)}),console.log(`🎯 Group moved to offset: ${e}, ${t}`),`Group moved to ${e}, ${t}`}adjustGroup(e,t){const o=parseFloat(this.config.groupOffset.x)||0,i=parseFloat(this.config.groupOffset.y)||0,n=`${o+parseFloat(e)}%`,s=`${i+parseFloat(t)}%`;return this.moveGroup(n,s)}resetGroupPosition(){return this.moveGroup("0%","0%")}getGroupPosition(){return{groupOffset:this.config.groupOffset,individual:this.engines.map(({config:e})=>({id:e.id,position:e.position}))}}enableRandomization(){return this.config.enableRandomization=!0,this.startRandomization(),"Randomization enabled"}disableRandomization(){return this.config.enableRandomization=!1,this.stopRandomization(),"Randomization disabled"}setRandomizationInterval(e){return this.config.randomizationInterval=e*1e3,this.randomizationTimer&&this.startRandomization(),`Randomization interval set to ${e} seconds`}forceRandomize(){return this.randomizeAllModels(),"Manual randomization triggered"}getRandomizationStatus(){return{enabled:this.config.enableRandomization,interval:this.config.randomizationInterval/1e3,currentModel:this.currentRandomModel,isRunning:!!this.randomizationTimer}}testCubeSettings(){if(this.engines[0]&&this.engines[0].engine){const e=this.engines[0].engine;return console.log("🎯 Current cube settings:",{autoRotate:e.autoRotate,rotationSpeed:e.rotationSpeed,modelScale:e.currentModel?e.currentModel.scale:"no model",textColor:e.textColor,cameraDistance:e.cameraDistance}),e.rotationSpeed=1e-4,console.log("🎯 Rotation speed forced to 0.0001 (20% of previous speed)"),"Test complete - check cube behavior"}return"No engines available"}updateEnginePosition(e,t,o){if(this.engines[e]){const i=this.engines[e].canvas;i.style.left=typeof t=="string"?t:t+"px",i.style.top=typeof o=="string"?o:o+"px",this.log(`Engine ${e} moved to (${t}, ${o})`)}}updateEngineSize(e,t,o){if(this.engines[e]){const i=this.engines[e].canvas;i.style.width=t+"px",i.style.height=o+"px",i.width=t,i.height=o,this.log(`Engine ${e} resized to ${t}x${o}`)}}updateEngineColor(e,t){this.engines[e]&&this.engines[e].engine.textColor!==void 0&&(this.engines[e].engine.textColor=t,this.log(`Engine ${e} color changed to ${t}`))}updateEngineOpacity(e,t){this.engines[e]&&(this.engines[e].canvas.style.opacity=t,this.log(`Engine ${e} opacity set to ${t}`))}updateEngineModel(e,t){this.engines[e]&&(this.loadModel(this.engines[e].engine,t),this.log(`Engine ${e} model changed to ${t}`))}toggleEngine(e,t){if(this.engines[e]){const o=this.engines[e].canvas;o.style.display=t?"block":"none",this.log(`Engine ${e} ${t?"enabled":"disabled"}`)}}toggleAllEngines(e){this.engines.forEach((t,o)=>{this.toggleEngine(o,e)}),this.log(`All engines ${e?"enabled":"disabled"}`)}log(e){this.config.enableLogging&&console.log(`🎨 StoreASCII: ${e}`)}destroy(){this.stopRandomization(),this.engines.forEach(({engine:e})=>{e&&e.dispose&&e.dispose()}),this.engines=[],this.initialized=!1,this.currentRandomModel=null,this.log("Store ASCII engines destroyed")}getConfig(){return this.config}updateGlobalConfig(e){this.config={...this.config,...e},this.log("Global configuration updated")}}class m{constructor(){this.loadingScreen=document.getElementById("loadingScreen"),this.init()}init(){setTimeout(()=>{this.hideLoading()},500)}hideLoading(){this.loadingScreen&&(this.loadingScreen.classList.add("loaded"),setTimeout(()=>{this.loadingScreen&&this.loadingScreen.remove()},800))}}class p{constructor(){this.loadingManager=new m,this.customNavigation=null,this.asciiController=null,this.initStore(),this.initEventListeners(),this.initNavigation(),this.initAsciiBackgrounds()}initStore(){this.shopifyDomain="pjm-studio.myshopify.com",this.apiAccessToken="",this.currentCategory="all",this.products=this.getAllProducts(),console.log("🛍️ Store initialized with",this.products.length,"products")}initEventListeners(){document.querySelectorAll(".filter-btn").forEach(i=>{i.addEventListener("click",n=>{this.handleCategoryFilter(n.target.dataset.category)})});const t=document.querySelector(".signup-btn");t&&t.addEventListener("click",this.handleNewsletterSignup.bind(this)),document.querySelectorAll(".product-btn").forEach(i=>{i.addEventListener("click",this.handleProductAction.bind(this))})}initNavigation(){this.customNavigation=new g({hideDelay:1500,enableLogging:!1})}async initAsciiBackgrounds(){document.querySelector(".access-lockout-overlay")?(console.log("🔥 Waiting for access control to complete..."),window.addEventListener("accessGranted",()=>{console.log("🔥 Access granted, initializing ASCII backgrounds..."),this.doInitAsciiBackgrounds()})):(console.log("🔥 No access control detected, initializing ASCII backgrounds..."),this.doInitAsciiBackgrounds())}async doInitAsciiBackgrounds(){try{console.log("🔥 Creating StoreAsciiController..."),this.asciiController=new f({enableLogging:!0,performanceMode:"medium"}),console.log("🔥 StoreAsciiController created:",this.asciiController),setTimeout(async()=>{console.log("🔥 Starting ASCII controller initialization..."),await this.asciiController.init(),console.log("🔥 Store ASCII backgrounds initialized"),console.log("🔥 Engines:",this.asciiController.engines)},1e3)}catch(e){console.error("🔥 ASCII backgrounds failed to initialize:",e)}}getAllProducts(){return document.querySelectorAll(".product-card")}handleCategoryFilter(e){document.querySelectorAll(".filter-btn").forEach(t=>{t.classList.remove("active")}),document.querySelector(`[data-category="${e}"]`).classList.add("active"),this.currentCategory=e,this.products.forEach(t=>{const o=t.dataset.category;e==="all"||o===e?(t.style.display="block",setTimeout(()=>{t.style.opacity="1",t.style.transform="translateY(0)"},50)):(t.style.opacity="0",t.style.transform="translateY(20px)",setTimeout(()=>{t.style.display="none"},200))}),console.log(`✨ Filtered to category: ${e}`)}handleNewsletterSignup(){const t=document.querySelector(".email-input").value.trim();if(!t){this.showNotification("Please enter your email address","error");return}if(!this.isValidEmail(t)){this.showNotification("Please enter a valid email address","error");return}this.simulateNewsletterSignup(t)}simulateNewsletterSignup(e){const t=document.querySelector(".signup-btn"),o=t.textContent;t.textContent="subscribing...",t.disabled=!0,setTimeout(()=>{t.textContent="✓ subscribed!",t.style.background="#ff00f6",this.showNotification("Successfully subscribed! You'll be notified when new products launch.","success"),document.querySelector(".email-input").value="",setTimeout(()=>{t.textContent=o,t.disabled=!1,t.style.background=""},3e3)},1500),console.log(`📧 Newsletter signup for: ${e}`)}handleProductAction(e){const t=e.target.closest(".product-card"),o=t.querySelector(".product-title").textContent;e.target.disabled?this.showNotification(`${o} is coming soon! Sign up for our newsletter to be notified.`,"info"):e.target.classList.contains("available")?this.handleAvailableProduct(e.target,t):this.addToCart(t)}handleAvailableProduct(e,t){const o=t.querySelector(".product-title").textContent,i=e.textContent;e.textContent="adding...",e.disabled=!0,setTimeout(()=>{e.textContent="✓ added to cart!",e.style.background="#ff00f6",this.showNotification(`${o} added to cart! (Demo mode - no actual purchase)`,"success"),setTimeout(()=>{e.textContent=i,e.disabled=!1,e.style.background=""},3e3)},1e3)}addToCart(e){const t=e.querySelector(".product-title").textContent;console.log(`🛒 Adding to cart: ${t}`),this.showNotification(`${t} added to cart!`,"success")}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}showNotification(e,t="info"){const o=h(e,t);o.className=`store-notification ${t}`,Object.assign(o.style,{position:"fixed",top:"80px",right:"24px",background:t==="success"?"#ff00f6":t==="error"?"#ef4444":"#6b7280",color:"white",padding:"12px 20px",border:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",zIndex:"10000",opacity:"0",transform:"translateX(100%)",transition:"all 0.3s ease",fontFamily:"Arial, sans-serif",fontSize:"14px",fontWeight:"300",maxWidth:"320px",borderRadius:"2px"}),document.body.appendChild(o),setTimeout(()=>{o.style.opacity="1",o.style.transform="translateX(0)"},100);const i=o.querySelector(".notification-close");i&&i.addEventListener("click",()=>{this.hideNotification(o)}),setTimeout(()=>{this.hideNotification(o)},4e3)}hideNotification(e){e&&e.parentNode&&(e.style.opacity="0",e.style.transform="translateX(100%)",setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300))}async initShopify(){}setupShopifyClient(){}destroy(){this.asciiController&&(this.asciiController.destroy(),this.asciiController=null),console.log("🧹 Store cleaned up")}}document.addEventListener("DOMContentLoaded",()=>{const l=new p;window.storeManager=l,setTimeout(()=>{l.asciiController&&(window.storeAscii=l.asciiController,console.log("🎨 ASCII controller available as window.storeAscii"),window.testAscii=()=>{var t,o,i,n,s,a;console.log("🎨 ASCII Test Results:"),console.log("- Controller exists:",!!window.storeAscii),console.log("- Controller initialized:",(t=window.storeAscii)==null?void 0:t.initialized),console.log("- Number of engines:",(i=(o=window.storeAscii)==null?void 0:o.engines)==null?void 0:i.length);const e=document.querySelectorAll(".store-ascii-canvas");return console.log("- Canvas elements found:",e.length),e.forEach((r,d)=>{console.log(`  Canvas ${d}: ${r.id}, visible: ${r.offsetParent!==null}`)}),{controller:!!window.storeAscii,initialized:(n=window.storeAscii)==null?void 0:n.initialized,engines:(a=(s=window.storeAscii)==null?void 0:s.engines)==null?void 0:a.length,canvases:e.length}},console.log("🎨 Run window.testAscii() to debug ASCII elements"))},2e3),console.log("🎯 PJM Studio Store initialized with Nova design system")});window.addEventListener("beforeunload",()=>{window.storeManager&&window.storeManager.destroy()});
